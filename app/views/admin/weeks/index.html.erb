<main class="PageAdminWeeksIndex">
  <h1>Недели</h1>

  <p><%= link_to 'Новая неделя', new_admin_week_path %></p>

  <% pagination_info = @pagy.count > 0 ? "#{@pagy.from}-#{@pagy.to} из #{@pagy.count}" : nil %>
  <%= render 'shared/organisms/O_ControlPanelTable',
      title: 'Недели',
      actions: pagination_info do %>
    <% if @weeks.any? %>
      <%= render 'shared/collections/C_ControlPanelTableHeaderRow', cells: [
        '#',
        'Название',
        'Публикация',
        'Действия'
      ] %>
      <% @weeks.each do |week| %>
        <%= render 'shared/collections/C_ControlPanelTableRow', cells: [
          week.number,
          link_to(week.title, admin_week_path(week)),
          "#{week.published_at.in_time_zone.strftime('%d.%m.%Y')} — #{week.expires_at.in_time_zone.strftime('%d.%m.%Y')}",
          "#{link_to('Редактировать', edit_admin_week_path(week))} | #{link_to('Удалить', admin_week_path(week), data: { turbo_method: :delete, turbo_confirm: 'Удалить неделю?' })}".html_safe
        ] %>
      <% end %>
    <% else %>
      <p>Нет недель</p>
    <% end %>
  <% end %>

  <%= pagy_nav(@pagy) if @pagy.pages > 1 %>
</main>

