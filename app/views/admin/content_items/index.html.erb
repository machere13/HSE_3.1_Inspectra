<main class="PageAdminContentItemsIndex">
  <h1>Контент недели <%= @week.number %></h1>

  <p><%= link_to 'Добавить контент', new_admin_week_content_item_path(@week) %></p>

  <% pagination_info = @pagy.count > 0 ? "#{@pagy.from}-#{@pagy.to} из #{@pagy.count}" : nil %>
  <%= render 'shared/organisms/O_ControlPanelTable',
      title: 'Контент',
      actions: pagination_info do %>
    <% if @content_items.any? %>
      <%= render 'shared/collections/C_ControlPanelTableHeaderRow', cells: [
        '#',
        'Тип',
        'Заголовок',
        'URL',
        'Действия'
      ] %>
      <% @content_items.each do |ci| %>
        <%= render 'shared/collections/C_ControlPanelTableRow', cells: [
          ci.position,
          ci.kind,
          link_to(ci.title.presence || '(без названия)', admin_week_content_item_path(@week, ci)),
          ci.url,
          "#{link_to('Редактировать', edit_admin_week_content_item_path(@week, ci))} | #{button_to('Удалить', admin_week_content_item_path(@week, ci), method: :delete, form: { data: { turbo_confirm: 'Удалить этот контент?' }, style: 'display:inline' })}".html_safe
        ] %>
      <% end %>
    <% else %>
      <p>Нет контента</p>
    <% end %>
  <% end %>

  <%= raw pagy_nav(@pagy) if @pagy.pages > 1 %>

  <%= link_to 'Назад к неделе', admin_week_path(@week) %>
</main>
